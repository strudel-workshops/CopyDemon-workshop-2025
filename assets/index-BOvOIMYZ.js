import{d as l,j as e,B as p,D as z,E as V,F as q,n as G,o as _,p as B,q as O,S as g,T as v,v as I,w as H,P as L,A,x as $,L as M}from"./index-fPyZG6U4.js";import{u as W,F as J,a as Q}from"./FilterField-C_KYt1qq.js";import{P as U}from"./PageHeader-fMNHnNfd.js";import{S as K}from"./SciDataGrid-CP3KsZCg.js";import{P as X}from"./react-plotly-BQ5--IX0.js";import{u as Y,f as Z,F as ee}from"./useListQuery-DJQlSHb7.js";import{S as te,D as re}from"./DataGrid-DZ9NVR2A.js";import{A as ae,C as ie}from"./Close-DyFPnqLI.js";import"./DatePicker-BAtWtL7Z.js";import"./DateCalendar-CCWEJX6A.js";import"./colorManipulator-dsZXJVSM.js";import"./Grid-dkDjLFA7.js";import"./useQuery-DNcqBgWZ.js";import"./useGridRootProps-C9cQ4pdT.js";import"./MenuItem-DMDLhBRH.js";import"./dividerClasses-Cfvlc6TK.js";import"./Divider-FsvZNKDt.js";const se=({value:s,all:i,current:n})=>{const[d,h]=l.useState(null),[x,u]=l.useState(null),b=l.useRef(null),m=l.useMemo(()=>i.map(o=>o.title),[i]),f=l.useMemo(()=>i.map(o=>o.stats.contributions),[i]),y=o=>{h(o.currentTarget)},j=()=>{h(null),u(null)},F=!!d,S=l.useMemo(()=>m.map((o,N)=>o===n.title?"red":x===N?"#ff6b6b":"#1f77b4"),[m,x,n.title]),R=l.useMemo(()=>[{x:m,y:f,type:"bar",marker:{color:S}}],[m,f,S]);return e.jsxs(p,{sx:{height:"100%"},children:[e.jsx(p,{onMouseEnter:y,onMouseLeave:j,sx:{height:"100%",display:"flex",alignItems:"center",cursor:"pointer"},children:s}),e.jsx(z,{id:"contributions-chart-popover",sx:{pointerEvents:"none"},open:F,anchorEl:d,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:j,disableRestoreFocus:!0,children:e.jsx(p,{ref:b,sx:{padding:2,pointerEvents:"auto"},children:e.jsx(X,{data:R,layout:{width:500,height:500,title:"Contributions Chart",margin:{t:40,r:20,b:40,l:40}},config:{displayModeBar:!1},onHover:o=>{o.points&&o.points.length>0&&u(o.points[0].pointIndex)},onUnhover:()=>{u(null)}})})})]})},ne=({filterConfigs:s,searchTerm:i,setPreviewItem:n})=>{const{activeFilters:d}=W(),[h,x]=l.useState(0),[u,b]=l.useState(25),[m,f]=l.useState(h*u),y="owner",j="client";let{isPending:F,isFetching:S,isError:R,data:o,error:N}=Y({activeFilters:d,dataSource:"dummy-data/explor.json",filterConfigs:s,offset:m,pageSize:u,queryMode:j,staticParams:null});const T=r=>{n(r.row)},k=r=>{const a=r.pageSize!==u?0:r.page,t=r.pageSize,c=a*t;x(a),b(t),f(c)};if(F){const a=new Array(u).fill(null).map((t,c)=>c);return e.jsx(p,{sx:{padding:2},children:a.map(t=>e.jsx(te,{height:50},t))})}return R?e.jsx(ae,{severity:"error",children:N.message}):e.jsxs(e.Fragment,{children:[S&&e.jsx(V,{variant:"indeterminate"}),e.jsx(K,{rows:Z(o,d,s,i),pagination:!0,paginationMode:j,onPaginationModelChange:k,getRowId:r=>r[y],columns:[{field:"name",headerName:"ID as name",type:"string",width:100,renderCell:r=>e.jsx(q,{href:`http://localhost:8081/contribs/projects/${r.value}`,target:"_blank",rel:"noopener noreferrer",underline:"hover",children:r.value})},{field:"title",headerName:"Title",width:400},{field:"owner",headerName:"Owner",width:400,valueGetter:r=>{let a=r.replace(/^google:/i,"");return a=a.replace(/@.*$/g,""),a}},{field:"is_public",headerName:"Public",width:150,type:"boolean"},{field:"is_approved",headerName:"Approved",width:150,type:"boolean"},{field:"stats.columns",headerName:"Columns",width:150,type:"number",valueGetter:(r,a)=>{var t;return(t=a.stats)==null?void 0:t.columns}},{field:"stats.contributions",headerName:"Contributions",width:150,type:"number",valueGetter:(r,a)=>{var t;return(t=a.stats)==null?void 0:t.contributions},renderCell:r=>e.jsx(se,{value:r.value,all:o,current:r})},{field:"stats.tables",headerName:"Tables",width:150,type:"number",valueGetter:(r,a)=>{var t;return(t=a.stats)==null?void 0:t.tables},sortComparator:(r,a,t,c)=>{const w=t.api.getCellValue(t.id,"stats.tables")??0,C=c.api.getCellValue(c.id,"stats.tables")??0;return w-C}},{field:"stats.structures",headerName:"Structures",width:150,type:"number",valueGetter:(r,a)=>{var t;return((t=a.stats)==null?void 0:t.structures)??0},sortComparator:(r,a,t,c)=>{const w=t.api.getCellValue(t.id,"stats.structures")??0,C=c.api.getCellValue(c.id,"stats.structures")??0;return w-C}},{field:"stats.attachments",headerName:"Attachments",width:150,type:"number",valueGetter:(r,a)=>{var t;return((t=a.stats)==null?void 0:t.attachments)??0},sortComparator:(r,a,t,c)=>{const w=t.api.getCellValue(t.id,"stats.attachments")??0,C=c.api.getCellValue(c.id,"stats.attachments")??0;return w-C}}],disableColumnSelector:!0,autoHeight:!0,initialState:{pagination:{paginationModel:{page:h,pageSize:u}}},onRowClick:T})]})};var P={},D;function oe(){if(D)return P;D=1;var s=G();Object.defineProperty(P,"__esModule",{value:!0}),P.default=void 0;var i=s(_()),n=B();return P.default=(0,i.default)((0,n.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList"),P}var le=oe();const de=O(le),ue=({searchTerm:s,setSearchTerm:i,onToggleFiltersPanel:n})=>{const d=h=>{i(h.target.value)};return e.jsxs(g,{direction:"row",spacing:2,alignItems:"center",sx:{overflow:"hidden",padding:2},children:[e.jsx(v,{variant:"h6",component:"h2",flex:1,children:"Entity List"}),e.jsx(I,{startIcon:e.jsx(de,{}),onClick:n,children:"Filters"}),e.jsx(H,{variant:"outlined",label:"Search",size:"small",value:s,onChange:d})]})},ce=({filterConfigs:s,onClose:i})=>e.jsx(ee,{grouped:!1,onClose:i,sx:{border:"none"},children:s.map((n,d)=>e.jsx(J,{field:n.field,label:n.label,operator:"contains",filterComponent:n.filterComponent,filterProps:n.filterProps},`${n.field}-${d}`))}),pe=[{field:"id",headerName:"ID",width:50},{field:"attr1",headerName:"Attribute 1",width:100},{field:"attr2",headerName:"Attribute 2",width:100},{field:"attr3",headerName:"Attribute 3",width:100}],he=Array(25).fill(0),me=he.map((s,i)=>({id:i,attr1:"value",attr2:"value",attr3:"value"})),xe=({previewItem:s,onClose:i})=>e.jsx(L,{elevation:0,sx:{height:"100%",padding:2},children:e.jsxs(g,{spacing:3,children:[e.jsxs(g,{spacing:1,children:[e.jsxs(g,{direction:"row",children:[e.jsx(v,{variant:"h6",component:"h3",flex:1,children:e.jsx(A,{to:"/explore-data/$id",params:{id:s.Id},children:s["Planet Name"]})}),e.jsx($,{size:"small",onClick:i,children:e.jsx(ie,{})})]}),e.jsx(v,{variant:"body2",children:"Row description, subtitle, or helper text."})]}),e.jsxs(p,{children:[e.jsx(v,{fontWeight:"medium",mb:1,children:"Property Group 1"}),e.jsx(M,{rows:[{label:"Property 1",value:"value"},{label:"Property 2",value:"value"},{label:"Property 3",value:"value"}]})]}),e.jsxs(p,{children:[e.jsx(v,{fontWeight:"medium",mb:1,children:"Property Group 2"}),e.jsx(M,{rows:[{label:"Property 4",value:"value"},{label:"Property 5",value:"value"}]})]}),e.jsxs(p,{children:[e.jsx(v,{fontWeight:"medium",mb:1,children:"Related Data"}),e.jsx(re,{rows:me,columns:pe,disableRowSelectionOnClick:!0,initialState:{pagination:{paginationModel:{pageSize:5}}}})]}),e.jsxs(g,{direction:"row",children:[e.jsx(A,{to:"/explore-data/$id",params:{id:s.Id},children:e.jsx(I,{variant:"contained",children:"View details"})}),e.jsx(I,{variant:"outlined",children:"Export data"})]})]})}),E=[{field:"title",label:"Project Title",operator:"contains",filterComponent:"TextField"},{field:"owner",label:"Project Owner",operator:"contains",filterComponent:"TextField"},{field:"is_public",label:"Public Status",operator:"equals-one-of",filterComponent:"CheckboxList",filterProps:{options:[{label:"Public",value:!0},{label:"Private",value:!1}]}},{field:"is_approved",label:"Approval Status",operator:"equals-one-of",filterComponent:"CheckboxList",filterProps:{options:[{label:"Approved",value:!0},{label:"Not Approved",value:!1}]}},{field:"stats.columns",label:"Number of Columns",operator:"between-inclusive",filterComponent:"RangeSlider",filterProps:{min:0,max:800}},{field:"stats.contributions",label:"Number of Contributions",operator:"between-inclusive",filterComponent:"RangeSlider",filterProps:{min:0,max:12e5}},{field:"stats.structures",label:"Number of Structures",operator:"between-inclusive",filterComponent:"RangeSlider",filterProps:{min:0,max:6e5}},{field:"stats.attachments",label:"Number of Attachments",operator:"between-inclusive",filterComponent:"RangeSlider",filterProps:{min:0,max:1e5}}],Ee=function(){const[i,n]=l.useState(""),[d,h]=l.useState(),[x,u]=l.useState(!0),b=()=>{u(!1)},m=()=>{u(!x)},f=()=>{h(null)};return e.jsx(Q,{children:e.jsxs(p,{children:[e.jsx(U,{pageTitle:"Explorer Data App",description:"Testing Material Project Contribution Explorer",sx:{marginBottom:1,padding:2}}),e.jsx(p,{children:e.jsxs(g,{direction:"row",children:[x&&e.jsx(p,{sx:{width:"350px"},children:e.jsx(ce,{filterConfigs:E,onClose:b})}),e.jsxs(L,{elevation:0,sx:{flex:1,minHeight:"600px",minWidth:0},children:[e.jsx(ue,{searchTerm:i,setSearchTerm:n,onToggleFiltersPanel:m}),e.jsx(ne,{filterConfigs:E,searchTerm:i,setPreviewItem:h})]}),d&&e.jsx(p,{sx:{minWidth:"400px"},children:e.jsx(xe,{previewItem:d,onClose:f})})]})})]})})};export{Ee as component};
